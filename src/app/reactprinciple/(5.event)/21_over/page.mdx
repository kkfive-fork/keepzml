
![](/images/reactprinciple/event/over/1.png)

我们在编写代码时，并不能直接将事件绑定在 DOM 节点上。因为 JSX 并非是真实 DOM。而最终事件的触发又只能是在真实 DOM 上。因此，React 必须提供一种机制，将 JSX 上的事件回调传递到真实 DOM 上。这一套机制，我们称之为**合成事件**。

我们编写的 JSX 代码第一时间并不会渲染成真实 DOM，因此，想要把事件传递到对应的真实 DOM 上，就必须借助**事件委托**的思路，将事件绑定在已经存在的父元素上。

> 事件委托是利用事件冒泡的机制，通过在父元素上设置监听器，可以捕获所有子元素触发的事件，然后通过 `event.target` 来判断事件源。

如上图所示，目前的版本中，React 将事件统一绑定在 `root` 节点上。

因此，在实现上，

+ 需要首先定义好事件回调的存储队列格式，后续会使用
+ **事件绑定**：然后会在 `root` 节点上注册所有支持的事件监听器，包括事件捕获与事件冒泡
+ 在 Fiber Tree 遍历构建过程中，如果发现节点中有定义事件回调，则创建合成事件，并与原生事件关联到一起
+ **事件触发**：最后当真实 DOM 触发事件监听时，会按照如下的执行顺序，执行对应节点的事件回调函数
  + 真实 DOM 事件从上到下捕获
  + 真实 DOM 事件从下到上冒泡
  + 触发 root 节点事件回调，根据 Fiber tree 自下而上收集事件任务到队列中
  + 遍历该队列
  + 合成事件从上到下捕获
  + 合成事件从下到上冒泡