import CodeTabs from 'components/codehike/code-tabs'
import Demo01 from './demo01/preview'


如何拆分组件，最小颗粒度到什么程度，是许多同学使用 React 的难点。然而这实际上是封装思维的进阶运用，因此考究的是你封装能力的火候。单独的文章无法迅速提高你的封装底层能力，它需要大量的思考与练习，但是我可以提供三个原则帮助大家尽可能的快速提高自己的封装能力。

### **1、明确什么时候需要封装**

封装的目的是为了简化代码。因此这两种情况下，我们都应该考虑封装代码。

首先，当代码量过大，造成阅读困难时。

其次，当相同或者类似的代码逻辑，出现多次时。

基于这两个前提条件，我们就可以做出如下决策。

### **2、人为约定组件的代码规模**

为了让代码保持简洁性，每一个组件的代码行数，应该尽可能的保持在一定的数量之内。我们可以约定为 200 行，或者 150 行，这根据团队的具体情况来定。一旦超出我们约定的行数，那么就表示我们需要将组件进行拆分了。这是一个非常棒的判断标准。

> 实际情况是，在没有正确的引导下，许多同学悲剧的将一个组件写出了几千行，甚至几万行代码，这维护成本杠杆的，别说没有，没准就是你

### **3、分析相同/类似 UI 的出现场景**

例如，当类似的列表出现多次，他们只是数据不同，但是数据格式相同，我们就可以封装成为一个 List 组件。这里的核心在于，找出组件的相同之处与差异之处。

### **4、关注数据**

数据作为影响组件的重要组成部分，是最容易被忽略的存在。也是最考验开发者思维的部分。许多项目为了避免数据对组件造成干扰，就使用了全局的状态管理工具 redux、mobx等等，将所有的数据都存放在全局的 store 中。

这是一种解决方案。但是过于简单粗暴，限制了开发者的创作能力。在大型项目中，甚至存在内存占用过多的隐患。因此，精准分析数据是 React 知命境的追求目标。

找准数据归属于谁，在实际开发中，最麻烦的地方在于许多数据，是由组件之间相互共享的。因此，解决这部分问题，跟理解闭包的场景有莫大的关系，关键词就在于：局部数据共享。

当组件之间共享数据，我们就应该把数据存放在他们最近的父组件之中

反过来说，**如果数据不存在共享，那么数据就应该属于对应组件私有**。在全局状态管理工具被滥用的今天，这一句话至关重要。