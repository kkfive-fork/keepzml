import Cardruntime from 'components/Cardruntime'
import MainCase from './case'

<Cardruntime><MainCase /></Cardruntime>

### 一、解耦

解耦实际上是一个非常抽象的说法，理解起来比较困难。**他建立在你对于语义化的掌握基础之上。**

当我们有能力，非常清晰的把某个逻辑片段赋予准确的语义，做逻辑解耦就是一个非常轻松的事情。

解耦之所以难，是因为当语义不明时，很多逻辑的边界非常模糊。本文中的案例，演示的是之前章节中，两个接口合并成一个列表的情况。我们在实现该逻辑时，分别抽象出来了 `controller` 层与 `service` 层。

`service` 层做的事情用语义表达出来的结果是：请求两个接口并将其返回的结果合并成一个列表。

`controller` 层做的事情是：将 `service` 层合并的列表，进行二次结构整理，补全与调整字段。

对于初学者而言，这里很容易引发的一个问题就是，这有必要吗？逻辑其实也不复杂，为什么要单独拆出来呢？我合在一起写可以不可以？

从功能上来说，肯定是可以的。你甚至也可以在架构中这样干

但是，这里需要注意的是，当你合在一起写之后，那么，这个专门针理数据的请求与处理的模块，我们就必须单独给他定义一个合理的语义：例如：数据层。

因此，我们发现，当 `service` 与 `controller` 层比较复杂，我们可以通过明确语义的方式，把他们解耦开来处理，从而降低开发难度。合在一起之后，变复杂的可能不是代码，而是你思考问题的复杂度。许多人觉得自己面临的问题很困难的根源就在这里。

正确的思考方式是基于语义化的理解，利用嵌套思维简化问题的复杂度，一层一层的去解决问题。


### 二、嵌套思维

在解决困难问题时，嵌套思维是一个必备的思维方式。也是架构师必须要具备的能力。我们以前面思考过的架构举例。

在之前我们介绍的是 `MVC + BFF` 混合的架构模式。但是有一个比较奇怪的地方，就是，当我们在单独思考数据层时，又划分了几个角色出来：`service`、`controller`、`model`

> 如果我们需要约定数据类型，那么我们可以把类型定义在 `model.d.ts` 中，来表示数据模型。

实际上，这就是嵌套思维。

当我们在思考整个组件时，我们需要考虑的是 `数据驱动 UI` 的角色如何处理。但是这个时候，我们并不会去考虑，如果数据太复杂了应该怎么办的问题。很多人在学习的时候，往往会觉得学习起来困难，就是因为他在这个时候，就已经开始超前思考数据太复杂了应该怎么办。有的人想了几年想不出答案，于是就自我评价说：我没有天赋。实际上情况并非如此，因为超前思考本身就是一件难度很大的事情。

在嵌套思维的指导下，此时我们应该模糊化数据层的复杂度。先把第一层的情况搞情况再说，然后再单独思考数据层。

当我们单独思考数据层时，这个时候的问题，就变成了：**如何给应用层提高一个它需要的数据。** 这个时候问题就简单了，因为应用层始终只需要一个数据。很多人会耦合接口个数的逻辑，在应用层中去处理多个请求结果，那么难度自然是很高的，写出来的代码也不优雅。

嵌套思维运用得好，你会发现他无处不在。例如函数中也能执行函数，div 也能成为一个父级元素，队列中可以包含队列，数组中也能包含数组。利用嵌套思维去解决这些问题，都会被你拆解得很简单。




