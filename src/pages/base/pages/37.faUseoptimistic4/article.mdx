import MainCase from './case/Layout'


### 一个复杂的案例

再来实现一个比较常见的点赞按钮的交互逻辑。演示效果如上图所示。具体需求如下：

当按钮处于灰色状态时，表示用户还未点赞该文章。点击之后，变成红色，表示点赞。

当按钮处于红色状态时，表示用户已经点赞该文章。点击之后变成灰色，表示取消点赞。

解决方案与前面提到的完全一致，同时也结合了 `useTransition` ，我们就不再一一分析步骤，直接展示完整代码

<MainCase />

在 api 的请求中，我们可以通过判断随机数的大小来模拟请求失败时的表现。目前请求失败的概率是 10%

```js
// api.js
export async function likeApi(message) {
  await new Promise((resolve, reject) => {
    setTimeout(() => {
      if (Math.random() > 0.1) {
        resolve(message)
      } else {
        reject(message)
      }
    }, 1000)
  });
  return message;
}
```

由于逻辑与之前几乎保持一致，因此本案例主要通过代码学习，未做详细讲解，完整代码如右侧所示。
